(()=>{var e={id:201,ids:[201]};e.modules={181:e=>{"use strict";e.exports=require("buffer")},290:e=>{"use strict";e.exports=require("async_hooks")},694:(e,t,r)=>{const s=r(6977),i=r(9358),a=r(5731),o=r(6665),n=r(8540),u=r(857),c=r(6928),p="action",d="snapshot-action";t.makeSnapshot=async function(){s.debug("Make a snapshot"),await o.exec("frieza",["snapshot","new",d,p])},t.addCredentials=async function(e,t,r){s.debug("Add credentials to frieza"),await o.exec("frieza",["profile","new","outscale_oapi",`--region=${r}`,`--ak=${e}`,`--sk=${t}`,p])},t.removeCredentials=async function(){s.debug("Remove credentials of frieza"),await o.exec("frieza",["profile","remove",p])},t.downloadBinary=async function(e){let t=await async function(e){let t="";t=""==e?"https://api.github.com/repos/outscale/frieza/releases/latest":`https://api.github.com/repos/outscale/frieza/releases/${e}`;let r=await n(t);return await r.json()}(e),r=t.tag_name;r.startsWith("v")&&(r=r.substring(1));const o="frieza_"+r+"_"+function(e){return{win32:"windows"}[e]||e}(u.platform())+"_"+({x32:"386",x64:"amd64"}[p=u.arch()]||p);var p;const d=function(e,t){for(const r of e)if(r.name.startsWith(t))return r.browser_download_url;throw new Error("Could not determine asset url")}(t.assets,o);s.debug(`Downloading Frieza from ${d}`);const l=await i.downloadTool(d);let x="";if(d.endsWith(".zip"))s.debug("Extracting Frieza zip file"),x=await i.extractZip(l);else{if(!d.endsWith(".tar.gz"))throw new Error("Unknown archive format");s.debug("Extracting Frieza tar file"),x=await i.extractTar(l)}if(s.debug(`Frieza path is ${x}.`),!l||!x)throw new Error(`Unable to download Frieza from ${d}`);return await async function(e,t){const r=u.platform().startsWith("win")?".exe":"";try{source=[e,`frieza_${t}${r}`].join(c.sep),target=[e,`frieza${r}`].join(c.sep),s.debug(`Moving ${source} to ${target}.`),await a.mv(source,target)}catch(e){throw s.error(`Unable to move ${source} to ${target}.`),e}}(x,`v${r}`),x},t.cleanAccount=async function(e){s.debug("Clean account"),await o.exec("frieza",["clean","--timeout="+e,"--auto-approve",d])},t.needsClean=async function(){return s.debug("Check if the account needs to be cleaned"),execOutput=o.getExecOutput("frieza",["clean","--plan","--json","--auto-approve",d]),execOutput.then(e=>(dataJson=JSON.parse(e.stderr),1==dataJson.targets.length&&0!=Object.keys(dataJson.targets[0].objects).length))}},857:e=>{"use strict";e.exports=require("os")},1637:e=>{"use strict";e.exports=require("diagnostics_channel")},2203:e=>{"use strict";e.exports=require("stream")},2613:e=>{"use strict";e.exports=require("assert")},2987:e=>{"use strict";e.exports=require("perf_hooks")},3106:e=>{"use strict";e.exports=require("zlib")},3193:e=>{"use strict";e.exports=require("string_decoder")},3480:e=>{"use strict";e.exports=require("querystring")},3557:e=>{"use strict";e.exports=require("timers")},3774:e=>{"use strict";e.exports=require("stream/web")},4236:e=>{"use strict";e.exports=require("console")},4434:e=>{"use strict";e.exports=require("events")},4756:e=>{"use strict";e.exports=require("tls")},4876:e=>{"use strict";e.exports=require("punycode")},5237:(e,t,r)=>{const s=r(6977),i=r(694);(async()=>{try{const e=s.getInput("access_key"),t=s.getInput("secret_key"),r=s.getInput("region"),a=s.getInput("release"),o=await i.downloadBinary(a);s.debug(`Add ${o} to PATH`),s.addPath(o),await i.addCredentials(e,t,r),await i.makeSnapshot()}catch(e){s.setFailed(e.message)}})()},5317:e=>{"use strict";e.exports=require("child_process")},5675:e=>{"use strict";e.exports=require("http2")},5692:e=>{"use strict";e.exports=require("https")},6928:e=>{"use strict";e.exports=require("path")},6982:e=>{"use strict";e.exports=require("crypto")},7016:e=>{"use strict";e.exports=require("url")},7075:e=>{"use strict";e.exports=require("node:stream")},7598:e=>{"use strict";e.exports=require("node:crypto")},7975:e=>{"use strict";e.exports=require("node:util")},8167:e=>{"use strict";e.exports=require("worker_threads")},8253:e=>{"use strict";e.exports=require("util/types")},8474:e=>{"use strict";e.exports=require("node:events")},8611:e=>{"use strict";e.exports=require("http")},9023:e=>{"use strict";e.exports=require("util")},9278:e=>{"use strict";e.exports=require("net")},9896:e=>{"use strict";e.exports=require("fs")}};var t=require("./shared.js");t.C(e),t.X(0,[964],()=>t(t.s=5237))})();